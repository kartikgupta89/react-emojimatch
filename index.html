<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Match</title>
    <link rel="shortcut icon" href="#">
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        #app {
        font-family: sans-serif;
        text-align: center;
        background-color: #f5f3ff;
        height: 95%;
        width: 95%;
        margin: 0.1rem;
        padding: 0.1rem;
        }

        /* input {
        margin: 0.1rem;
        padding: 0.2rem;
        border: dotted grey 0.3rem;
        text-align: center;
        font-size: 3rem;
        height: 3rem;
        width: 8rem;
        } */

        h2 {
        font-style: italic;
        }

        footer {
        text-align: right;
        font-size: 0.5rem;
        font-style: italic;
        color: black;
        background-color: #f5f3ff;
        padding: 0.2rem;
        }

        .symbol {
        font-size: 2rem;
        padding: 0.5rem;
        cursor: pointer;
        }

        .match-container {
        display: grid;
        grid-template-columns: 4fr 4fr 2fr;
        text-align: left;
        padding: 1rem;
        margin: 0.1rem;
        grid-gap: 1rem;
        align-items: center;
        }

    </style>
</head>

<body>
    <div id="app"></div>

    <script type="text/babel">
        const emojiDictionary = {
            "😀": "Grinning Face",
            "😃": "Grinning Face with Big Eyes",
            "😄": "Grinning Face with Smiling Eyes",
            "😁": "Beaming Face with Smiling Eyes",
            "😆": "Grinning Squinting Face",
            "😅": "Grinning Face with Sweat",
            "🤣": "Rolling on the Floor Laughing",
            "😂": "Face with Tears of Joy",
            "🙂": "Slightly Smiling Face",
            "🙃": "Upside-Down Face",
            "😉": "Winking Face",
            "😊": "Smiling Face with Smiling Eyes",
            "😇": "Smiling Face with Halo",
            "🥰": "Smiling Face with Hearts",
            "😍": "Smiling Face with Heart-Eyes",
            "🤩": "Star-Struck",
            "😘": "Face Blowing a Kiss",
            "😗": "Kissing Face"
        };

        class App extends React.Component {
            
            constructor(props) {
                super(props);
                this.state = {               
                    emojisWeKnow: this.shuffle(Object.keys(emojiDictionary)).slice(0,5),
                    answers: Array(5).fill("")
                };
                console.log("App constructor called");
            }

            shuffle = (inArray) => {
                var array = [...inArray];
                for (let i = array.length - 1; i > 0; i--) {
                    let j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return (array);
            }

            render() {
                const rows = this.state.emojisWeKnow.map((emojiKey, i) => {
                    // console.log("sent from top", this.state.emojisWeKnow, emojiKey, i);
                    return (
                        <AppRow 
                            emojiKey={emojiKey} 
                            emojisWeKnow={this.state.emojisWeKnow} 
                            rowIndex={i} 
                            // handleClickRight={() => this.handleClickRight(i)}
                            // handleClickWrong={() => this.handleClickWrong(i)}
                            // answers={this.state.answers}
                            key={i}
                        />
                    );
                })

                return (
                    <div>
                        <h2>Find the Emoji!</h2>
                        <div>{rows}</div>
                        <footer>KG</footer>
                    </div>
                );
            }

            handleClickRight = (i) => {
                var tmp = this.state.answers;
                tmp[i] = "Right";
                console.log(i, tmp);
                this.setState({
                   answers: [...tmp]
                });
            }

            handleClickWrong = (i) => {
                var tmp = this.state.answers;
                tmp[i] = "Wrong";
                console.log(i, tmp);
                this.setState({
                   answers: [...tmp]
                });
            }
        }

        class AppRow extends React.Component {
            constructor(props) {
                super(props);
                this.state = {
                    emojisInRow: this.shuffle(this.props.emojisWeKnow),
                    answer: "Click to guess..."
                };
                console.log("AppRow constructor called", this.state.emojisInRow)
            }

            shuffle = (inArray) => {
                var array = [...inArray];
                for (let i = array.length - 1; i > 0; i--) {
                    let j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return (array);
            }

            render() {   
                console.log("props", this.props.emojisWeKnow);
                console.log("state ", this.state.emojisInRow);
                return (
                    <div className="match-container">
                        <span>
                            {emojiDictionary[this.props.emojiKey]}
                        </span>
                        <span>
                            {
                                this.state.emojisInRow.map((emojiRowItem, emojiRowIndex) => {
                                    return (
                                        <span className="symbol"
                                            key={emojiRowIndex} 
                                            onClick={() => this.handleClick(emojiRowItem)}
                                        >
                                            {emojiRowItem}
                                        </span>
                                    );
                                })
                            }
                        </span>
                        <span>
                            {//this.props.answers[this.props.rowIndex]
                            }
                            {this.state.answer}
                        </span>
                    </div>
                );
            }

            handleClick = (emojiRowItem) => {
                // console.log("clicked", emojiRowItem);
                if(emojiRowItem === this.props.emojiKey) {
                    // this.props.handleClickRight();
                    this.setState({
                        answer: "Right!"
                    });
                } else {
                    // this.props.handleClickWrong();
                    this.setState({
                        answer: "Wrong! Try again."
                    })
                }
            }
        }

        ReactDOM.render(<App />, document.querySelector("#app"))    
    </script>

</body>
</html>